# Generated Kestra Workflow for Monday.com Board: {{ board_name }}
# Generated: {{ generation_timestamp }}

id: {{ script_name }}
namespace: company.team
description: "sync monday board {{ board_name }} with Azure SQL"

tasks:
  - id: setup_and_log
    type: io.kestra.plugin.core.log.Log
    message: |
      ğŸš€ Starting Workflow: {{ "{{ flow.id }}" }}
      ğŸ“… Timestamp: {{ "{{ now() }}" }}
      ğŸ·ï¸  Namespace: {{ "{{ flow.namespace }}" }}
      ğŸ“ Description: sync monday board {{ board_name }} with Azure SQL
      ğŸ“ Script Location: scripts/{{ "{{ flow.id }}" }}/
      ğŸ—„ï¸  Database Connections: 1
      ğŸ“Š Target Table: {{ database }}.dbo.{{ table_name }}
      
  - id: execute_main_workflow
    type: io.kestra.plugin.core.flow.WorkingDirectory
    description: "Execute {{ "{{ flow.id }}" }} main script with environment configuration"
    namespaceFiles:
      enabled: true
      include:
        - scripts/{{ "{{ flow.id }}" }}/**
    tasks:
      - id: run_main_script
        type: io.kestra.plugin.scripts.python.Commands
        taskRunner:
          type: io.kestra.plugin.scripts.runner.docker.Docker
          pullPolicy: NEVER
        containerImage: my-custom-kestra:latest
        description: "Execute main workflow logic for {{ "{{ flow.id }}" }}"
        namespaceFiles:
          enabled: true
        commands:
          - echo "ğŸš€ === sync monday board {{ board_name }} with Azure SQL Starting ==="
          - echo "ğŸ“„ Executing main script for {{ "{{ flow.id }}" }}..."
          - python scripts/{{ "{{ flow.id }}" }}/{{ script_name }}.py
          - echo "âœ… === sync monday board {{ board_name }} with Azure SQL Completed ==="
          
  - id: completion_log
    type: io.kestra.plugin.core.log.Log
    message: |
      âœ… Workflow completed successfully!
      ğŸ¯ Workflow: {{ "{{ flow.id }}" }}
      ğŸ“Š Results: Check task outputs above for detailed execution results
      â° Completed at: {{ "{{ now() }}" }}
      ğŸ—„ï¸  Target Table: {{ database }}.dbo.{{ table_name }}

{% if schedule -%}
triggers:
  - id: schedule
    type: io.kestra.core.models.triggers.types.Schedule
    cron: "{{ schedule }}"
{% endif -%}

labels:
  board_id: "{{ board_id }}"
  board_name: "{{ board_name }}"
  table_name: "{{ table_name }}"
  database: "{{ database }}"
  generated_by: "Dynamic Monday.com Board Template System"
