-- ---------------------------------------------------------------------------
--  Hybrid transformation procedure for ORDER_LIST
--  VERSION       : 1
--  GENERATED AT  : 2025-07-08T23:27:29Z
--  SOURCE TABLE  : ORDER_LIST
--  RAW TABLES    : x*_ORDER_LIST_RAW
-- ---------------------------------------------------------------------------
CREATE OR ALTER PROCEDURE dbo.sp_Transform_ORDER_LIST_Hybrid
AS
BEGIN
    SET NOCOUNT ON;

    -- Staging table (truncate/reload every run)
    IF OBJECT_ID('dbo.swp_ORDER_LIST', 'U') IS NULL
        SELECT * INTO dbo.swp_ORDER_LIST
        FROM dbo.ORDER_LIST WHERE 1 = 0;
    ELSE
        TRUNCATE TABLE dbo.swp_ORDER_LIST;

    -- Log table for per-raw stats
    IF OBJECT_ID('dbo.etl_ORDER_LIST_stats', 'U') IS NULL
        CREATE TABLE dbo.etl_ORDER_LIST_stats (
            run_id        INT          IDENTITY(1,1) PRIMARY KEY,
            table_name    NVARCHAR(128),
            rows_loaded   INT,
            load_time     DATETIME2,
            error_msg     NVARCHAR(4000)
        );

    DECLARE @t NVARCHAR(128), @rc INT, @start DATETIME2, @err NVARCHAR(4000);
    DECLARE @sql NVARCHAR(MAX);

    DECLARE raw_tables CURSOR FOR
        SELECT t.name
        FROM sys.tables t
        WHERE t.name LIKE 'x%_ORDER_LIST_RAW'
        ORDER BY t.name;

    OPEN raw_tables;
    FETCH NEXT FROM raw_tables INTO @t;

    WHILE @@FETCH_STATUS = 0
    BEGIN
        SET @start = SYSDATETIME();
        SET @err = NULL;
        BEGIN TRY
            -- Build SQL for dynamic execution
            SET @sql = N'
                INSERT INTO dbo.swp_ORDER_LIST ([AAG ORDER NUMBER], [CUSTOMER NAME], [ORDER DATE PO RECEIVED], [PO NUMBER], [CUSTOMER ALT PO], [AAG SEASON], [CUSTOMER SEASON], [DROP], [MONTH], [RANGE / COLLECTION], [PROMO GROUP / CAMPAIGN (HOT 30/GLOBAL EDIT)], [CATEGORY], [PATTERN ID], [PLANNER], [MAKE OR BUY], [ORIGINAL ALIAS/RELATED ITEM], [PRICING ALIAS/RELATED ITEM], [ALIAS/RELATED ITEM], [CUSTOMER STYLE], [STYLE DESCRIPTION], [CUSTOMER''S COLOUR CODE (CUSTOM FIELD) CUSTOMER PROVIDES THIS], [CUSTOMER COLOUR DESCRIPTION], [UNIT OF MEASURE], [INFOR WAREHOUSE CODE], [BULK AGREEMENT NUMBER], [INFOR FACILITY CODE], [INFOR BUSINESS UNIT AREA], [BULK AGREEMENT DESCRIPTION], [CO NUMBER - INITIAL DISTRO], [INFOR CUSTOMER CODE], [CO NUMBER - ALLOCATION DISTRO], [CO NUMBER (INITIAL DISTRO)], [CO NUMBER (ALLOCATION DISTRO)], [INFOR ORDER TYPE], [INFOR SEASON CODE], [ITEM TYPE CODE], [PRODUCT GROUP CODE], [ITEM GROUP CODE], [PLANNER2], [GENDER GROUP CODE], [FABRIC TYPE CODE], [INFOR MAKE/BUY CODE], [INFOR ITEM TYPE CODE], [INFOR PRODUCT GROUP CODE], [INFOR ITEM GROUP CODE], [INFOR GENDER GROUP CODE], [INFOR FABRIC TYPE CODE], [LONGSON ALIAS], [INFOR COLOUR CODE], [FACILITY CODE], [CUSTOMER CODE], [Column2], [Column1], [AAG SEASON CODE], [MAKE OR BUY FLAG], [MAKE/BUY CODE], [0-3M], [10/M], [11-12 years], [12-18M], [12/18 MTHS], [13-14 years], [18-24M], [18/24 MTHS], [1Y], [2Y], [3-4 years], [3-6M], [3/6 MTHS], [3Y], [4Y], [5-6 years], [6-12M], [6-9M], [6/12 MTHS], [7-8 years], [9-10 years], [9-12M], [10-12], [10/11], [11-14], [12-14], [12/13], [2/3], [2T], [3-4], [30/30], [30/32], [31/30], [31/32], [32/30], [32/32], [32/34], [32/36], [33/30], [33/32], [34/30], [34/32], [34/34], [35/30], [35/32], [36/30], [36/32], [36/34], [38/30], [38/32], [38/34], [38/36], [3T], [4/5], [40/30], [40/32], [4T], [4XT], [5-6], [5T], [6-10], [6/7], [6T], [7-8], [8/9], [9-10], [L(10-12)], [L(14-16)], [M(10-12)], [M(8-10)], [S(6-8)], [04/XXS], [06/XS], [08/S], [12/L], [14/XL], [16/XXL], [18/XXXL], [1X], [2X], [2XL], [3X], [3XL], [4X], [4XL], [L], [M], [S], [S+], [S-PETITE], [XL], [XS], [XS-PETITE], [XXL], [XXS], [XXXL], [XXXS], [L-XL], [S-M], [S/P], [XL/2XL], [XXL/3XL], [XXS/XS], [0], [0w], [1], [10], [10w], [12], [12w], [14], [16], [18], [2], [20], [22], [24], [25], [26], [27], [28], [29], [2w], [3], [30], [31], [32], [33], [34], [35], [36], [38], [4], [40], [42], [43], [44], [45], [46], [48], [4w], [5], [50], [52], [54], [56], [58], [6], [60], [6w], [7], [8], [8w], [9], [28-30L], [30-30L], [30-31L], [30-32L], [30X30], [30x32], [31-30L], [31-31L], [31-32L], [31X30], [32-30L], [32-31L], [32-32L], [32X30], [32x32], [32x34], [33-30L], [33-31L], [33-32L], [34-30L], [34-31L], [34-32L], [34X30], [34x32], [34x34], [35-30L], [35-31L], [35-32L], [36-30L], [36-31L], [36-32L], [36X30], [36x32], [36x34], [38-30L], [38-31L], [38-32L], [38X30], [38x32], [38x34], [40-30L], [40-31L], [40X30], [40x32], [40x34], [AB/M], [AB/S], [AB/XL], [C/L], [C/M], [C/S], [C/XL], [C/XS], [CD/L], [CD/M], [CD/S], [CD/XL], [CD/XS], [D/L], [D/M], [D/S], [D/XL], [D/XS], [D/XXL], [L/XL], [M/L], [O/S], [S/M], [XL/XXL], [XS/S], [32C], [32D], [32DD], [32DDD], [34C], [34D], [34DD], [34DDD], [36C], [36D], [36DD], [36DDD], [38C], [38D], [38DD], [38DDD], [ONE SIZE], [OS], [One Sz], [One_Sz], [TOTAL QTY], [DESTINATION], [DESTINATION WAREHOUSE], [ALLOCATION (CHANNEL)], [SHOP NAME], [SHOP CODE], [COLLECTION DELIVERY], [ETA CUSTOMER WAREHOUSE DATE], [EX FACTORY DATE], [DELIVERY TERMS], [PLANNED DELIVERY METHOD], [NOTES], [ORDER TYPE], [VALIDATION], [VALIDATION2], [VALIDATION3], [VALIDATION4], [CUSTOMER PRICE], [USA ONLY LSTP 75% EX WORKS], [EX WORKS (USD)], [ADMINISTRATION FEE], [DESIGN FEE], [FX CHARGE], [HANDLING], [PNP], [SURCHARGE FEE], [DISCOUNT], [FINAL FOB (USD)], [HS CODE], [US DUTY RATE], [US DUTY], [FREIGHT], [US TARIFF RATE], [US TARIFF], [DDP US (USD)], [UK DUTY RATE], [UK FREIGHT], [UK INSURANCE], [UK CIF], [UK DUTY], [DDP UK (USD)], [CAN DUTY RATE], [CAN DUTY], [DDP CAN (USD)], [SMS PRICE USD], [FINAL PRICES Y/N], [NOTES FOR PRICE], [âˆ†], [INFOR ADDRESS ID], [TRACKING NUMBER], [INFOR DELIVERY CODE], [COUNTRY OF ORIGIN], [DELIVERY CODE (MODL)], [FX CHARGE 2 Dec], [INFOR EX-WORKS 4 Dec], [AU Product 4 Dec], [AU PnP 4 Dec], [AU Price 2 Dec], [AU Discount 2 Dec], [US Product 4 Dec], [US PnP 4 Dec], [US Duty 2 Dec], [US Tariff 2 Dec], [TARIFF RELIEF DISCOUNT (20%)], [US Price 2 Dec], [FOB TO USE ON PRODUCT INVOICE], [US Discount 2 Dec], [US Price w/ Discount], [CAN Product 4 Dec], [ADDITIONAL TARIFF RATE], [CAN PnP 4 Dec], [CAN Duty 2 Dec], [ADDITIONAL TARIFF %], [ADDITIONAL TARIFF], [CAN Price 2 Dec], [ADDITIONAL TARIFF VALUE], [CAN Discount 2 Dec], [TARIFF RATE CHARGED TO AAG], [CAN Price w/ Discount], [TARIFF LOSS], [UK Product 4 Dec], [UK PnP 4 Dec], [INVOICE METHOD], [UK Duty 2 Dec], [UK Price 2 Dec], [UK Discount 2 Dec], [UK Price w/ Discount], [RMB price (ex. VAT)], [RMB Discount 2 Dec], [RMB Price w/ Discount], [PRICING NOTES], [NASC TO ROC PRICE (RMB) (inc VAT)], [FINANCE EST (USD)], [Warehouse], [NASC TO WHITE FOX (USD)], [INVOICE MONTH], [INVOICE YEAR], [ORTP (ORDER TYPE)], [HDPR], [PATTERN/STYLE NAME], [RRP], [PFI EXCHANGE RATE], [FOB (AUD)], [BUAR (BUSINESS AREA UNIT)], [MARGIN], [ADID])
                SELECT NULLIF(TRIM(' + QUOTENAME('AAG ORDER NUMBER') + '), ''''), NULLIF(TRIM(' + QUOTENAME('CUSTOMER NAME') + '), ''''),                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL, NULLIF(TRIM(' + QUOTENAME('PROMO GROUP / CAMPAIGN (HOT 30/GLOBAL EDIT') + '), ''''),                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL,                             NULL                FROM ' + QUOTENAME(@t) + ';
            ';

            -- PRINT @sql;
            EXEC sp_executesql @sql;
            SET @rc = @@ROWCOUNT;
        END TRY
        BEGIN CATCH
            SET @err = ERROR_MESSAGE();
            SET @rc = 0;
        END CATCH

        INSERT INTO dbo.etl_ORDER_LIST_stats (table_name, rows_loaded, load_time, error_msg)
        VALUES (@t, @rc, SYSDATETIME(), @err);

        FETCH NEXT FROM raw_tables INTO @t;
    END

    CLOSE raw_tables;
    DEALLOCATE raw_tables;

    -- Atomic swap (truncate and reload main table)
    BEGIN TRANSACTION;
        TRUNCATE TABLE dbo.ORDER_LIST;
        INSERT INTO dbo.ORDER_LIST ([AAG ORDER NUMBER], [CUSTOMER NAME], [ORDER DATE PO RECEIVED], [PO NUMBER], [CUSTOMER ALT PO], [AAG SEASON], [CUSTOMER SEASON], [DROP], [MONTH], [RANGE / COLLECTION], [PROMO GROUP / CAMPAIGN (HOT 30/GLOBAL EDIT)], [CATEGORY], [PATTERN ID], [PLANNER], [MAKE OR BUY], [ORIGINAL ALIAS/RELATED ITEM], [PRICING ALIAS/RELATED ITEM], [ALIAS/RELATED ITEM], [CUSTOMER STYLE], [STYLE DESCRIPTION], [CUSTOMER'S COLOUR CODE (CUSTOM FIELD) CUSTOMER PROVIDES THIS], [CUSTOMER COLOUR DESCRIPTION], [UNIT OF MEASURE], [INFOR WAREHOUSE CODE], [BULK AGREEMENT NUMBER], [INFOR FACILITY CODE], [INFOR BUSINESS UNIT AREA], [BULK AGREEMENT DESCRIPTION], [CO NUMBER - INITIAL DISTRO], [INFOR CUSTOMER CODE], [CO NUMBER - ALLOCATION DISTRO], [CO NUMBER (INITIAL DISTRO)], [CO NUMBER (ALLOCATION DISTRO)], [INFOR ORDER TYPE], [INFOR SEASON CODE], [ITEM TYPE CODE], [PRODUCT GROUP CODE], [ITEM GROUP CODE], [PLANNER2], [GENDER GROUP CODE], [FABRIC TYPE CODE], [INFOR MAKE/BUY CODE], [INFOR ITEM TYPE CODE], [INFOR PRODUCT GROUP CODE], [INFOR ITEM GROUP CODE], [INFOR GENDER GROUP CODE], [INFOR FABRIC TYPE CODE], [LONGSON ALIAS], [INFOR COLOUR CODE], [FACILITY CODE], [CUSTOMER CODE], [Column2], [Column1], [AAG SEASON CODE], [MAKE OR BUY FLAG], [MAKE/BUY CODE], [0-3M], [10/M], [11-12 years], [12-18M], [12/18 MTHS], [13-14 years], [18-24M], [18/24 MTHS], [1Y], [2Y], [3-4 years], [3-6M], [3/6 MTHS], [3Y], [4Y], [5-6 years], [6-12M], [6-9M], [6/12 MTHS], [7-8 years], [9-10 years], [9-12M], [10-12], [10/11], [11-14], [12-14], [12/13], [2/3], [2T], [3-4], [30/30], [30/32], [31/30], [31/32], [32/30], [32/32], [32/34], [32/36], [33/30], [33/32], [34/30], [34/32], [34/34], [35/30], [35/32], [36/30], [36/32], [36/34], [38/30], [38/32], [38/34], [38/36], [3T], [4/5], [40/30], [40/32], [4T], [4XT], [5-6], [5T], [6-10], [6/7], [6T], [7-8], [8/9], [9-10], [L(10-12)], [L(14-16)], [M(10-12)], [M(8-10)], [S(6-8)], [04/XXS], [06/XS], [08/S], [12/L], [14/XL], [16/XXL], [18/XXXL], [1X], [2X], [2XL], [3X], [3XL], [4X], [4XL], [L], [M], [S], [S+], [S-PETITE], [XL], [XS], [XS-PETITE], [XXL], [XXS], [XXXL], [XXXS], [L-XL], [S-M], [S/P], [XL/2XL], [XXL/3XL], [XXS/XS], [0], [0w], [1], [10], [10w], [12], [12w], [14], [16], [18], [2], [20], [22], [24], [25], [26], [27], [28], [29], [2w], [3], [30], [31], [32], [33], [34], [35], [36], [38], [4], [40], [42], [43], [44], [45], [46], [48], [4w], [5], [50], [52], [54], [56], [58], [6], [60], [6w], [7], [8], [8w], [9], [28-30L], [30-30L], [30-31L], [30-32L], [30X30], [30x32], [31-30L], [31-31L], [31-32L], [31X30], [32-30L], [32-31L], [32-32L], [32X30], [32x32], [32x34], [33-30L], [33-31L], [33-32L], [34-30L], [34-31L], [34-32L], [34X30], [34x32], [34x34], [35-30L], [35-31L], [35-32L], [36-30L], [36-31L], [36-32L], [36X30], [36x32], [36x34], [38-30L], [38-31L], [38-32L], [38X30], [38x32], [38x34], [40-30L], [40-31L], [40X30], [40x32], [40x34], [AB/M], [AB/S], [AB/XL], [C/L], [C/M], [C/S], [C/XL], [C/XS], [CD/L], [CD/M], [CD/S], [CD/XL], [CD/XS], [D/L], [D/M], [D/S], [D/XL], [D/XS], [D/XXL], [L/XL], [M/L], [O/S], [S/M], [XL/XXL], [XS/S], [32C], [32D], [32DD], [32DDD], [34C], [34D], [34DD], [34DDD], [36C], [36D], [36DD], [36DDD], [38C], [38D], [38DD], [38DDD], [ONE SIZE], [OS], [One Sz], [One_Sz], [TOTAL QTY], [DESTINATION], [DESTINATION WAREHOUSE], [ALLOCATION (CHANNEL)], [SHOP NAME], [SHOP CODE], [COLLECTION DELIVERY], [ETA CUSTOMER WAREHOUSE DATE], [EX FACTORY DATE], [DELIVERY TERMS], [PLANNED DELIVERY METHOD], [NOTES], [ORDER TYPE], [VALIDATION], [VALIDATION2], [VALIDATION3], [VALIDATION4], [CUSTOMER PRICE], [USA ONLY LSTP 75% EX WORKS], [EX WORKS (USD)], [ADMINISTRATION FEE], [DESIGN FEE], [FX CHARGE], [HANDLING], [PNP], [SURCHARGE FEE], [DISCOUNT], [FINAL FOB (USD)], [HS CODE], [US DUTY RATE], [US DUTY], [FREIGHT], [US TARIFF RATE], [US TARIFF], [DDP US (USD)], [UK DUTY RATE], [UK FREIGHT], [UK INSURANCE], [UK CIF], [UK DUTY], [DDP UK (USD)], [CAN DUTY RATE], [CAN DUTY], [DDP CAN (USD)], [SMS PRICE USD], [FINAL PRICES Y/N], [NOTES FOR PRICE], [âˆ†], [INFOR ADDRESS ID], [TRACKING NUMBER], [INFOR DELIVERY CODE], [COUNTRY OF ORIGIN], [DELIVERY CODE (MODL)], [FX CHARGE 2 Dec], [INFOR EX-WORKS 4 Dec], [AU Product 4 Dec], [AU PnP 4 Dec], [AU Price 2 Dec], [AU Discount 2 Dec], [US Product 4 Dec], [US PnP 4 Dec], [US Duty 2 Dec], [US Tariff 2 Dec], [TARIFF RELIEF DISCOUNT (20%)], [US Price 2 Dec], [FOB TO USE ON PRODUCT INVOICE], [US Discount 2 Dec], [US Price w/ Discount], [CAN Product 4 Dec], [ADDITIONAL TARIFF RATE], [CAN PnP 4 Dec], [CAN Duty 2 Dec], [ADDITIONAL TARIFF %], [ADDITIONAL TARIFF], [CAN Price 2 Dec], [ADDITIONAL TARIFF VALUE], [CAN Discount 2 Dec], [TARIFF RATE CHARGED TO AAG], [CAN Price w/ Discount], [TARIFF LOSS], [UK Product 4 Dec], [UK PnP 4 Dec], [INVOICE METHOD], [UK Duty 2 Dec], [UK Price 2 Dec], [UK Discount 2 Dec], [UK Price w/ Discount], [RMB price (ex. VAT)], [RMB Discount 2 Dec], [RMB Price w/ Discount], [PRICING NOTES], [NASC TO ROC PRICE (RMB) (inc VAT)], [FINANCE EST (USD)], [Warehouse], [NASC TO WHITE FOX (USD)], [INVOICE MONTH], [INVOICE YEAR], [ORTP (ORDER TYPE)], [HDPR], [PATTERN/STYLE NAME], [RRP], [PFI EXCHANGE RATE], [FOB (AUD)], [BUAR (BUSINESS AREA UNIT)], [MARGIN], [ADID])
        SELECT[AAG ORDER NUMBER], [CUSTOMER NAME], [ORDER DATE PO RECEIVED], [PO NUMBER], [CUSTOMER ALT PO], [AAG SEASON], [CUSTOMER SEASON], [DROP], [MONTH], [RANGE / COLLECTION], [PROMO GROUP / CAMPAIGN (HOT 30/GLOBAL EDIT)], [CATEGORY], [PATTERN ID], [PLANNER], [MAKE OR BUY], [ORIGINAL ALIAS/RELATED ITEM], [PRICING ALIAS/RELATED ITEM], [ALIAS/RELATED ITEM], [CUSTOMER STYLE], [STYLE DESCRIPTION], [CUSTOMER'S COLOUR CODE (CUSTOM FIELD) CUSTOMER PROVIDES THIS], [CUSTOMER COLOUR DESCRIPTION], [UNIT OF MEASURE], [INFOR WAREHOUSE CODE], [BULK AGREEMENT NUMBER], [INFOR FACILITY CODE], [INFOR BUSINESS UNIT AREA], [BULK AGREEMENT DESCRIPTION], [CO NUMBER - INITIAL DISTRO], [INFOR CUSTOMER CODE], [CO NUMBER - ALLOCATION DISTRO], [CO NUMBER (INITIAL DISTRO)], [CO NUMBER (ALLOCATION DISTRO)], [INFOR ORDER TYPE], [INFOR SEASON CODE], [ITEM TYPE CODE], [PRODUCT GROUP CODE], [ITEM GROUP CODE], [PLANNER2], [GENDER GROUP CODE], [FABRIC TYPE CODE], [INFOR MAKE/BUY CODE], [INFOR ITEM TYPE CODE], [INFOR PRODUCT GROUP CODE], [INFOR ITEM GROUP CODE], [INFOR GENDER GROUP CODE], [INFOR FABRIC TYPE CODE], [LONGSON ALIAS], [INFOR COLOUR CODE], [FACILITY CODE], [CUSTOMER CODE], [Column2], [Column1], [AAG SEASON CODE], [MAKE OR BUY FLAG], [MAKE/BUY CODE], [0-3M], [10/M], [11-12 years], [12-18M], [12/18 MTHS], [13-14 years], [18-24M], [18/24 MTHS], [1Y], [2Y], [3-4 years], [3-6M], [3/6 MTHS], [3Y], [4Y], [5-6 years], [6-12M], [6-9M], [6/12 MTHS], [7-8 years], [9-10 years], [9-12M], [10-12], [10/11], [11-14], [12-14], [12/13], [2/3], [2T], [3-4], [30/30], [30/32], [31/30], [31/32], [32/30], [32/32], [32/34], [32/36], [33/30], [33/32], [34/30], [34/32], [34/34], [35/30], [35/32], [36/30], [36/32], [36/34], [38/30], [38/32], [38/34], [38/36], [3T], [4/5], [40/30], [40/32], [4T], [4XT], [5-6], [5T], [6-10], [6/7], [6T], [7-8], [8/9], [9-10], [L(10-12)], [L(14-16)], [M(10-12)], [M(8-10)], [S(6-8)], [04/XXS], [06/XS], [08/S], [12/L], [14/XL], [16/XXL], [18/XXXL], [1X], [2X], [2XL], [3X], [3XL], [4X], [4XL], [L], [M], [S], [S+], [S-PETITE], [XL], [XS], [XS-PETITE], [XXL], [XXS], [XXXL], [XXXS], [L-XL], [S-M], [S/P], [XL/2XL], [XXL/3XL], [XXS/XS], [0], [0w], [1], [10], [10w], [12], [12w], [14], [16], [18], [2], [20], [22], [24], [25], [26], [27], [28], [29], [2w], [3], [30], [31], [32], [33], [34], [35], [36], [38], [4], [40], [42], [43], [44], [45], [46], [48], [4w], [5], [50], [52], [54], [56], [58], [6], [60], [6w], [7], [8], [8w], [9], [28-30L], [30-30L], [30-31L], [30-32L], [30X30], [30x32], [31-30L], [31-31L], [31-32L], [31X30], [32-30L], [32-31L], [32-32L], [32X30], [32x32], [32x34], [33-30L], [33-31L], [33-32L], [34-30L], [34-31L], [34-32L], [34X30], [34x32], [34x34], [35-30L], [35-31L], [35-32L], [36-30L], [36-31L], [36-32L], [36X30], [36x32], [36x34], [38-30L], [38-31L], [38-32L], [38X30], [38x32], [38x34], [40-30L], [40-31L], [40X30], [40x32], [40x34], [AB/M], [AB/S], [AB/XL], [C/L], [C/M], [C/S], [C/XL], [C/XS], [CD/L], [CD/M], [CD/S], [CD/XL], [CD/XS], [D/L], [D/M], [D/S], [D/XL], [D/XS], [D/XXL], [L/XL], [M/L], [O/S], [S/M], [XL/XXL], [XS/S], [32C], [32D], [32DD], [32DDD], [34C], [34D], [34DD], [34DDD], [36C], [36D], [36DD], [36DDD], [38C], [38D], [38DD], [38DDD], [ONE SIZE], [OS], [One Sz], [One_Sz], [TOTAL QTY], [DESTINATION], [DESTINATION WAREHOUSE], [ALLOCATION (CHANNEL)], [SHOP NAME], [SHOP CODE], [COLLECTION DELIVERY], [ETA CUSTOMER WAREHOUSE DATE], [EX FACTORY DATE], [DELIVERY TERMS], [PLANNED DELIVERY METHOD], [NOTES], [ORDER TYPE], [VALIDATION], [VALIDATION2], [VALIDATION3], [VALIDATION4], [CUSTOMER PRICE], [USA ONLY LSTP 75% EX WORKS], [EX WORKS (USD)], [ADMINISTRATION FEE], [DESIGN FEE], [FX CHARGE], [HANDLING], [PNP], [SURCHARGE FEE], [DISCOUNT], [FINAL FOB (USD)], [HS CODE], [US DUTY RATE], [US DUTY], [FREIGHT], [US TARIFF RATE], [US TARIFF], [DDP US (USD)], [UK DUTY RATE], [UK FREIGHT], [UK INSURANCE], [UK CIF], [UK DUTY], [DDP UK (USD)], [CAN DUTY RATE], [CAN DUTY], [DDP CAN (USD)], [SMS PRICE USD], [FINAL PRICES Y/N], [NOTES FOR PRICE], [âˆ†], [INFOR ADDRESS ID], [TRACKING NUMBER], [INFOR DELIVERY CODE], [COUNTRY OF ORIGIN], [DELIVERY CODE (MODL)], [FX CHARGE 2 Dec], [INFOR EX-WORKS 4 Dec], [AU Product 4 Dec], [AU PnP 4 Dec], [AU Price 2 Dec], [AU Discount 2 Dec], [US Product 4 Dec], [US PnP 4 Dec], [US Duty 2 Dec], [US Tariff 2 Dec], [TARIFF RELIEF DISCOUNT (20%)], [US Price 2 Dec], [FOB TO USE ON PRODUCT INVOICE], [US Discount 2 Dec], [US Price w/ Discount], [CAN Product 4 Dec], [ADDITIONAL TARIFF RATE], [CAN PnP 4 Dec], [CAN Duty 2 Dec], [ADDITIONAL TARIFF %], [ADDITIONAL TARIFF], [CAN Price 2 Dec], [ADDITIONAL TARIFF VALUE], [CAN Discount 2 Dec], [TARIFF RATE CHARGED TO AAG], [CAN Price w/ Discount], [TARIFF LOSS], [UK Product 4 Dec], [UK PnP 4 Dec], [INVOICE METHOD], [UK Duty 2 Dec], [UK Price 2 Dec], [UK Discount 2 Dec], [UK Price w/ Discount], [RMB price (ex. VAT)], [RMB Discount 2 Dec], [RMB Price w/ Discount], [PRICING NOTES], [NASC TO ROC PRICE (RMB) (inc VAT)], [FINANCE EST (USD)], [Warehouse], [NASC TO WHITE FOX (USD)], [INVOICE MONTH], [INVOICE YEAR], [ORTP (ORDER TYPE)], [HDPR], [PATTERN/STYLE NAME], [RRP], [PFI EXCHANGE RATE], [FOB (AUD)], [BUAR (BUSINESS AREA UNIT)], [MARGIN], [ADID]FROM dbo.swp_ORDER_LIST;
    COMMIT TRANSACTION;
END
GO